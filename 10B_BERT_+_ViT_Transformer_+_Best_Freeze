{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"10B_BERT_+_ViT_Transformer_+_Best_Freeze","provenance":[],"collapsed_sections":[],"machine_shape":"hm","toc_visible":true},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"9e229cbc1b294edd8a403fc44db25b64":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_960464733f784dd8a3ad309e2db5b9b4","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_32ddbde6375c46a7b123207a9cf40eb0","IPY_MODEL_c50ead940c3f48f0a7f130670b6c2b15","IPY_MODEL_9a6774711c0d43b7904f3fe0bb65b4e0"]}},"960464733f784dd8a3ad309e2db5b9b4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"32ddbde6375c46a7b123207a9cf40eb0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_cac8e3e19687461f9bb5738b8d463de3","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validation sanity check: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_353ba2d949f346a094dd4cb2ad90f06c"}},"c50ead940c3f48f0a7f130670b6c2b15":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_3ba21f17e9b046b58c4536635ff1d7f9","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":2,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":2,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1d74e0b8322047b19b7d019c7c188a75"}},"9a6774711c0d43b7904f3fe0bb65b4e0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_226b011c5f594052a7dbc782f223e90f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 2/2 [00:00&lt;00:00,  3.23it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_98fb25332fa7439facfd6112c4a36b6a"}},"cac8e3e19687461f9bb5738b8d463de3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"353ba2d949f346a094dd4cb2ad90f06c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3ba21f17e9b046b58c4536635ff1d7f9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"1d74e0b8322047b19b7d019c7c188a75":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"226b011c5f594052a7dbc782f223e90f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"98fb25332fa7439facfd6112c4a36b6a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8c9ce6732f0842d68f3689fe0f38b4d7":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_0853f5f280a848b6a9249261338159eb","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_e0e286ac31974dab8dba3dd86f7a80bd","IPY_MODEL_ec3081dc666e44c7b7cfcdf401895120","IPY_MODEL_e165f3a236164d7c972728e1f9ed3d9b"]}},"0853f5f280a848b6a9249261338159eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"e0e286ac31974dab8dba3dd86f7a80bd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_73b4d1fdeb1943b6ae0c5c7da7f0aad8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Epoch 10: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1c8fc21453784c06874a3ac717773fde"}},"ec3081dc666e44c7b7cfcdf401895120":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6d76908c03ed4bd69906dde73f655179","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1562,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1562,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_efee10c7e44c4fabb3806693e74ce66a"}},"e165f3a236164d7c972728e1f9ed3d9b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_bf84d1469c464a3db7f83c641f020ad4","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1562/1562 [14:39&lt;00:00,  1.78it/s, loss=0.7, v_num=1, validate_loss=0.691, validate_acc=0.495, validate_f1=0.336, train_loss=0.695]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_cd5bb988f3884d42b3497429201efd5b"}},"73b4d1fdeb1943b6ae0c5c7da7f0aad8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"1c8fc21453784c06874a3ac717773fde":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6d76908c03ed4bd69906dde73f655179":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"efee10c7e44c4fabb3806693e74ce66a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bf84d1469c464a3db7f83c641f020ad4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"cd5bb988f3884d42b3497429201efd5b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f5e945e01e784b7e841c896de5494528":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_fd3a5007ead044c2819736270e5be6d8","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_4259195735bf4a37a7a5d714157c8c3d","IPY_MODEL_6666ef1d4c5a45ffb3d854935822dbbd","IPY_MODEL_568505b3b5f84f65a3d9a8cd9ff44a02"]}},"fd3a5007ead044c2819736270e5be6d8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"4259195735bf4a37a7a5d714157c8c3d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_1a7c5201e0684e79922efe5d5403c0ed","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validating: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9a9ae0b4d5834b98b5ee0a109d9c0aea"}},"6666ef1d4c5a45ffb3d854935822dbbd":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_9b80ceb865b6414d83537e12d695db43","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":312,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":312,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8b0f01a547504f08b11edf8c5c0e35b2"}},"568505b3b5f84f65a3d9a8cd9ff44a02":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ac3284bd1f07408786204d8d6613e59d","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 312/312 [01:32&lt;00:00,  3.36it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6eb3760dc2774bfe875444674ddc27fa"}},"1a7c5201e0684e79922efe5d5403c0ed":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"9a9ae0b4d5834b98b5ee0a109d9c0aea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9b80ceb865b6414d83537e12d695db43":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"8b0f01a547504f08b11edf8c5c0e35b2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ac3284bd1f07408786204d8d6613e59d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"6eb3760dc2774bfe875444674ddc27fa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2c5a18ae2b594f0c800775d3b5442680":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_7d3d63fb4ac54a3da255873d0be2ae7d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_bd2661adde7f4b499ba43637af931a8a","IPY_MODEL_b0842995ec6648f9b0a1787cf5a81916","IPY_MODEL_dee47fd2479a4a7995ca9b8197656d1f"]}},"7d3d63fb4ac54a3da255873d0be2ae7d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"bd2661adde7f4b499ba43637af931a8a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_2e12c55daffd41278ea73212d3957a76","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validating: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_854a0eb2c639403f8459026cb46c8483"}},"b0842995ec6648f9b0a1787cf5a81916":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_cc06a8a1d18d44dbb2242a2533b4f34c","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":312,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":312,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_48d85c9ab4864453a1ebb6e6e0d965b8"}},"dee47fd2479a4a7995ca9b8197656d1f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_52c189c57a2345049361670444091408","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 312/312 [01:32&lt;00:00,  3.36it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7d7ab68515c14065a156a14ca54e612e"}},"2e12c55daffd41278ea73212d3957a76":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"854a0eb2c639403f8459026cb46c8483":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cc06a8a1d18d44dbb2242a2533b4f34c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"48d85c9ab4864453a1ebb6e6e0d965b8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"52c189c57a2345049361670444091408":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7d7ab68515c14065a156a14ca54e612e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"accfb7f1f884448e9d2f4a54222289a3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_6ba0bf27dfff48a1a3785fa259753536","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c7855ed240e2442d8fe25983fc7208d3","IPY_MODEL_42aa4c9f9f3e46e08a3c173169e14482","IPY_MODEL_311693a48e0e40b7ab0757c9a58c3d66"]}},"6ba0bf27dfff48a1a3785fa259753536":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"c7855ed240e2442d8fe25983fc7208d3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_b315d756f4d54cb381eb12b084941b24","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validating: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_448e79a6cf7a4b6e984b368f4ad52867"}},"42aa4c9f9f3e46e08a3c173169e14482":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_316a0f6b8025465b8fd16411b5ad9e80","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":312,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":312,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_62367fb5f5aa44ba86204cb5bbda5a1d"}},"311693a48e0e40b7ab0757c9a58c3d66":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_574dd20364b34c1ab7b1ce5bd9ac4f1f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 312/312 [01:32&lt;00:00,  3.36it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1adaace6526c48c08d1a0661a3e8309d"}},"b315d756f4d54cb381eb12b084941b24":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"448e79a6cf7a4b6e984b368f4ad52867":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"316a0f6b8025465b8fd16411b5ad9e80":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"62367fb5f5aa44ba86204cb5bbda5a1d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"574dd20364b34c1ab7b1ce5bd9ac4f1f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"1adaace6526c48c08d1a0661a3e8309d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7037575f14784457a76c004416321362":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_fdba797e892d4a10a1ee208f7143a889","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_54604457238f48b88293aec84231142f","IPY_MODEL_6b1b7c4fb54a4abdbecd38865bcb8b5b","IPY_MODEL_355749dd22a745ec94c9a181e2470a1e"]}},"fdba797e892d4a10a1ee208f7143a889":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"54604457238f48b88293aec84231142f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_0785086396ed4784a7fd4c21e9b68c12","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validating: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f9943b77264348398fcb2dce7057bed6"}},"6b1b7c4fb54a4abdbecd38865bcb8b5b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_2f6dc19968674e228c71b780caedf125","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":312,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":312,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f8703951361d4bfeb05e3e15c19a9f96"}},"355749dd22a745ec94c9a181e2470a1e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_93cb6c0dc9264e7090ea57e717e56507","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 312/312 [01:32&lt;00:00,  3.37it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_4b5da6ba154e47be8fa519894f6cc8d4"}},"0785086396ed4784a7fd4c21e9b68c12":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"f9943b77264348398fcb2dce7057bed6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2f6dc19968674e228c71b780caedf125":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"f8703951361d4bfeb05e3e15c19a9f96":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"93cb6c0dc9264e7090ea57e717e56507":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"4b5da6ba154e47be8fa519894f6cc8d4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"dbb5d44215914b19be591466408039f6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_07d5256254094700947561f7c89abd6b","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_d942473b012a4079aec0d9bd930bcd16","IPY_MODEL_ca9fd28739e54d0eb229590a71fac68f","IPY_MODEL_7007aa08c10644c6a2c2a7ffd51bae25"]}},"07d5256254094700947561f7c89abd6b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"d942473b012a4079aec0d9bd930bcd16":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_9bbd61688d7e426db1da4e60f7c2e6e9","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validating: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_59a52e99f82d4cf1b8489c49fc783f86"}},"ca9fd28739e54d0eb229590a71fac68f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_a379eae42840434a85b39b604109a231","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":312,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":312,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_43b73c525e6141a6ad324eea98ed8996"}},"7007aa08c10644c6a2c2a7ffd51bae25":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_10f3d58e5de04d9b865263ff751968d8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 312/312 [01:32&lt;00:00,  3.38it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_025b9792b2d344faa243b0a14844f594"}},"9bbd61688d7e426db1da4e60f7c2e6e9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"59a52e99f82d4cf1b8489c49fc783f86":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a379eae42840434a85b39b604109a231":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"43b73c525e6141a6ad324eea98ed8996":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"10f3d58e5de04d9b865263ff751968d8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"025b9792b2d344faa243b0a14844f594":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ec285f6025be48d2b649544361ef204b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_62d1b95e7ebd467ba9d8249440978cc4","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_db205e25d9104db0ac6c515c7d272232","IPY_MODEL_09bbaf95db5149acb17739445ad066b4","IPY_MODEL_b9ebb0ce3c8f4c91a4b56f8f1ab21cc7"]}},"62d1b95e7ebd467ba9d8249440978cc4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"db205e25d9104db0ac6c515c7d272232":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_861940bfe9ab461c8cda4ee8185f5353","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validating: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1cda4165a39d45e08448d8d10af503f8"}},"09bbaf95db5149acb17739445ad066b4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_dacb7d6836824a80a51f1046be08eabc","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":312,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":312,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_43558caee02840a092b7a8a11aec7f32"}},"b9ebb0ce3c8f4c91a4b56f8f1ab21cc7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_3692c6be3e494accad94cd26f990aeb7","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 312/312 [01:32&lt;00:00,  3.38it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_4895f2e3bd2b42ee84eb7d8040031c27"}},"861940bfe9ab461c8cda4ee8185f5353":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"1cda4165a39d45e08448d8d10af503f8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"dacb7d6836824a80a51f1046be08eabc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"43558caee02840a092b7a8a11aec7f32":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3692c6be3e494accad94cd26f990aeb7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"4895f2e3bd2b42ee84eb7d8040031c27":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"af3e6c5c6b364bf88131d3595d269b87":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e7dadf3ffaa84bbfbf838480a5f2726a","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_80647379f9364e7183ef8e1b28814b51","IPY_MODEL_3ccbf7e1ca08463ab8ba2137b8920e8a","IPY_MODEL_8c6cf3f7de1f48ccaab3bd0055f858e5"]}},"e7dadf3ffaa84bbfbf838480a5f2726a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"80647379f9364e7183ef8e1b28814b51":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_0a5ce6f2ecaf434daf1731df27c08c2f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validating: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_71db9a3127d3409689164c37d63538fd"}},"3ccbf7e1ca08463ab8ba2137b8920e8a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_bbf95ed5b4d94c9da4abd3fdeaf0ade3","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":312,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":312,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b634992e6bd448cdb03ccf1584cf001f"}},"8c6cf3f7de1f48ccaab3bd0055f858e5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_cd0d0ffa374f4463bb3db3b57263e73c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 312/312 [01:32&lt;00:00,  3.38it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_2c9b175f4cb84cb2ac2bdb8d5c44e038"}},"0a5ce6f2ecaf434daf1731df27c08c2f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"71db9a3127d3409689164c37d63538fd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bbf95ed5b4d94c9da4abd3fdeaf0ade3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"b634992e6bd448cdb03ccf1584cf001f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cd0d0ffa374f4463bb3db3b57263e73c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"2c9b175f4cb84cb2ac2bdb8d5c44e038":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"65eccfd178484106907e539a64cf5c0f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_144411001c674d598b8d637f1355e4eb","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_22696c5d00b64f6d8ec964ff22f1f1a6","IPY_MODEL_776e58f85c2e485fb4e56186e93eb8dc","IPY_MODEL_4202364f88c64339b3a0c9f9df47204f"]}},"144411001c674d598b8d637f1355e4eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"22696c5d00b64f6d8ec964ff22f1f1a6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f50fe07b4e83459a8bae4eab29ca7b5a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validating: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8ab37dda737e41dbb5b55aea4a95466c"}},"776e58f85c2e485fb4e56186e93eb8dc":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_58fbfb621d2143bd9629022a3cfc15a8","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":312,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":312,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8366cf0526c24a23ba40ab2089da00d1"}},"4202364f88c64339b3a0c9f9df47204f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_8ffb0e1f7e604f9a9ce1588f7b80fbbf","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 312/312 [01:32&lt;00:00,  3.37it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e491ac40d82e42cfae23e4edb55b22de"}},"f50fe07b4e83459a8bae4eab29ca7b5a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"8ab37dda737e41dbb5b55aea4a95466c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"58fbfb621d2143bd9629022a3cfc15a8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"8366cf0526c24a23ba40ab2089da00d1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8ffb0e1f7e604f9a9ce1588f7b80fbbf":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"e491ac40d82e42cfae23e4edb55b22de":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"68ecee54c913419fb4e30706cfc760b0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d9da09de56e4466b9edbe261fd929d89","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_0cd8aa3bb0e64946bd810a3ceaea629d","IPY_MODEL_8be68cff59c240fda531f2b0c9db8e6b","IPY_MODEL_acfb490f951247c08c986f423cd6f52a"]}},"d9da09de56e4466b9edbe261fd929d89":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"0cd8aa3bb0e64946bd810a3ceaea629d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_5a17a8a937c2440dbbb001af667a939c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validating: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_07855c9539bd42db9eb7a58bfebc257e"}},"8be68cff59c240fda531f2b0c9db8e6b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_a0c75ebd1ba44170957050f2578b5241","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":312,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":312,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6742ba23397a4bccb94e2da499b209fd"}},"acfb490f951247c08c986f423cd6f52a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_3a354a7fde8744199f5b5fd8518c4158","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 312/312 [01:32&lt;00:00,  3.37it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6dd3e8776162426e9aeebc4a450eea63"}},"5a17a8a937c2440dbbb001af667a939c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"07855c9539bd42db9eb7a58bfebc257e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a0c75ebd1ba44170957050f2578b5241":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"6742ba23397a4bccb94e2da499b209fd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3a354a7fde8744199f5b5fd8518c4158":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"6dd3e8776162426e9aeebc4a450eea63":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fcdbaa4ff86e4901bff0f92c3391e561":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_3343d45c2a9640ab9ccd4e9a16d7f396","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c5d8a849d592431d838a28e5424d4b66","IPY_MODEL_903de00386944fa6ad08f20eb266ab01","IPY_MODEL_875b7cb0c21841be9b1fe2904b1a0427"]}},"3343d45c2a9640ab9ccd4e9a16d7f396":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"c5d8a849d592431d838a28e5424d4b66":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_eaf9660139d9459c970b31911a861ce8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validating: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_483ad874fd0e4e879ccdc5a96215723a"}},"903de00386944fa6ad08f20eb266ab01":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_d8cfd37b4c3e40c5a66ca4604ae9d562","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":312,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":312,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6150fd0038a248dba2d9eebf25ce635a"}},"875b7cb0c21841be9b1fe2904b1a0427":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_5bfab547f1904f9a9cd827fff1eb1f90","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 312/312 [01:32&lt;00:00,  3.37it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_598b8bbb13aa4196bdf0b4a18e1f6a23"}},"eaf9660139d9459c970b31911a861ce8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"483ad874fd0e4e879ccdc5a96215723a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d8cfd37b4c3e40c5a66ca4604ae9d562":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"6150fd0038a248dba2d9eebf25ce635a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5bfab547f1904f9a9cd827fff1eb1f90":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"598b8bbb13aa4196bdf0b4a18e1f6a23":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"922a6525a0a940b48031e8666e842941":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_f81b3f6f974a4f71b967e8fb041e43b4","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c56793a150e54117b4beeca9dcfa8073","IPY_MODEL_0c53b7743c6343cbaf80eadb9ca92fe4","IPY_MODEL_004d22cec7ff4a39aae2fd95a08b4e55"]}},"f81b3f6f974a4f71b967e8fb041e43b4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"c56793a150e54117b4beeca9dcfa8073":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_35097746c33948768a9da2a6d79bd5e8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Validating: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_068cd51f4488406c9adabb33c7bf30b6"}},"0c53b7743c6343cbaf80eadb9ca92fe4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_dc60e49d35cc43378b9886d3187a7486","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"","max":312,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":312,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7d4cf761dde34a878ff76c10f2f8583a"}},"004d22cec7ff4a39aae2fd95a08b4e55":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_32a2014a926a4cc68f6495682fdb994f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 312/312 [01:32&lt;00:00,  3.37it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_dd658345a30b460f903771fcfbec084d"}},"35097746c33948768a9da2a6d79bd5e8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"068cd51f4488406c9adabb33c7bf30b6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"dc60e49d35cc43378b9886d3187a7486":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"7d4cf761dde34a878ff76c10f2f8583a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"32a2014a926a4cc68f6495682fdb994f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"dd658345a30b460f903771fcfbec084d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"907542da152948a0b8213d06d9c36504":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_01e58a4bad344f15b13451e226f5a2b4","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_f6de14af2dd74cd3b26f399fc5bdcd4b","IPY_MODEL_9ff556e9c2374fb1a495c4da2c3543ea","IPY_MODEL_c32859b824334d808c686a7829a0d2b7"]}},"01e58a4bad344f15b13451e226f5a2b4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":"row wrap","width":"100%","min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":"inline-flex","left":null}},"f6de14af2dd74cd3b26f399fc5bdcd4b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ce93ab7b08ef4da9981cdda21bdaf835","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Testing: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_707f88d60b36466db4dcecf1591bd6ef"}},"9ff556e9c2374fb1a495c4da2c3543ea":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_512c2e61580743c989cf8096446356d4","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_17a110a2ebc2400aba8ef4c88b396eae"}},"c32859b824334d808c686a7829a0d2b7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_0fec8a15271f485e9cc3f4e9a9dce03e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1562/1562 [07:41&lt;00:00,  3.38it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_92ff72c9cf3e48729b9f9229bc87a434"}},"ce93ab7b08ef4da9981cdda21bdaf835":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"707f88d60b36466db4dcecf1591bd6ef":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"512c2e61580743c989cf8096446356d4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"17a110a2ebc2400aba8ef4c88b396eae":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":"2","_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0fec8a15271f485e9cc3f4e9a9dce03e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"92ff72c9cf3e48729b9f9229bc87a434":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"qsYrvhouXxSQ"},"source":["# BERT com camadas ViT"]},{"cell_type":"markdown","metadata":{"id":"yVOH-To1S03j"},"source":["# Preparando Dados , Imports e Instalações"]},{"cell_type":"code","metadata":{"id":"jfDJtD90S03k","executionInfo":{"status":"ok","timestamp":1638994464137,"user_tz":180,"elapsed":3494,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}}},"source":["!pip install -q install transformers pytorch_lightning neptune-client==0.9.8"],"execution_count":1,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"28Y_YYjFS03m","executionInfo":{"status":"ok","timestamp":1638994467306,"user_tz":180,"elapsed":3174,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}},"outputId":"4860c70f-a353-4234-86dc-e0c88217cc2a"},"source":["import torch\n","import random\n","from torch.utils.data import DataLoader\n","import torchmetrics\n","from torch import nn\n","import numpy as np\n","import pytorch_lightning as pl\n","from pytorch_lightning import LightningModule, Trainer\n","from transformers import BertModel\n","from transformers import AutoTokenizer\n","import neptune.new as neptune\n","from transformers import ViTModel\n","\n","pl.utilities.seed.seed_everything(seed=123)"],"execution_count":2,"outputs":[{"output_type":"stream","name":"stderr","text":["Global seed set to 123\n"]},{"output_type":"execute_result","data":{"text/plain":["123"]},"metadata":{},"execution_count":2}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Cb9p4IiVS03n","executionInfo":{"status":"ok","timestamp":1638994467308,"user_tz":180,"elapsed":12,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}},"outputId":"4ceb84ab-72ba-4593-bfff-d6a7494f0269"},"source":["if torch.cuda.is_available(): \n","   dev = \"cuda:0\"\n","   print(torch. cuda. get_device_name(dev))\n","else: \n","   dev = \"cpu\" \n","print(dev)\n","device = torch.device(dev)"],"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Tesla P100-PCIE-16GB\n","cuda:0\n"]}]},{"cell_type":"code","metadata":{"id":"2yLMMPChS03n","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1638994480908,"user_tz":180,"elapsed":13608,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}},"outputId":"1993c19b-af0d-4d7a-dc39-501e7f1c10b1"},"source":["!wget -nc http://files.fast.ai/data/aclImdb.tgz \n","!tar -xzf aclImdb.tgz"],"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["File ‘aclImdb.tgz’ already there; not retrieving.\n","\n"]}]},{"cell_type":"code","metadata":{"id":"YFtSTffvS03p","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1638994482125,"user_tz":180,"elapsed":1231,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}},"outputId":"61c61f61-02d3-4a06-8720-d8e53af2ed50"},"source":["import os\n","\n","max_valid = 5000\n","\n","def load_texts(folder):\n","    texts = []\n","    for path in os.listdir(folder):\n","        with open(os.path.join(folder, path)) as f:\n","            texts.append(f.read())\n","    return texts\n","\n","x_train_pos = load_texts('aclImdb/train/pos')\n","x_train_neg = load_texts('aclImdb/train/neg')\n","x_test_pos = load_texts('aclImdb/test/pos')\n","x_test_neg = load_texts('aclImdb/test/neg')\n","\n","x_train = x_train_pos + x_train_neg\n","x_test = x_test_pos + x_test_neg\n","y_train = [True] * len(x_train_pos) + [False] * len(x_train_neg)\n","y_test = [True] * len(x_test_pos) + [False] * len(x_test_neg)\n","\n","# Embaralhamos o treino para depois fazermos a divisão treino/valid.\n","c = list(zip(x_train, y_train))\n","random.shuffle(c)\n","x_train, y_train = zip(*c)\n","\n","x_valid = x_train[-max_valid:]\n","y_valid = y_train[-max_valid:]\n","x_train = x_train[:-max_valid]\n","y_train = y_train[:-max_valid]\n","\n","print(len(x_train), 'amostras de treino.')\n","print(len(x_valid), 'amostras de desenvolvimento.')\n","print(len(x_test), 'amostras de teste.')\n","\n","print('3 primeiras amostras treino:')\n","for x, y in zip(x_train[:3], y_train[:3]):\n","    print(y, x[:100])\n","\n","print('3 últimas amostras treino:')\n","for x, y in zip(x_train[-3:], y_train[-3:]):\n","    print(y, x[:100])\n","\n","print('3 primeiras amostras validação:')\n","for x, y in zip(x_valid[:3], y_test[:3]):\n","    print(y, x[:100])\n","\n","print('3 últimas amostras validação:')\n","for x, y in zip(x_valid[-3:], y_valid[-3:]):\n","    print(y, x[:100])"],"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["20000 amostras de treino.\n","5000 amostras de desenvolvimento.\n","25000 amostras de teste.\n","3 primeiras amostras treino:\n","False There's so many negative reviews about \"Stay away, Joe\" in here I just can't stay quiet any longer a\n","False Excruciatingly slow-paced, over-scripted black comedy with a too-clever premise and bad acting.<br /\n","True This is cult stuff. My friends and I get together once a year to enjoy this movie. Its very funny an\n","3 últimas amostras treino:\n","False I have been waiting for this movie a long time. Especially because Juhi Chawla is in this, she's a g\n","True Its not Braveheart( thankfully),but it is fine entertainment with engaging characters and good actin\n","True Not being a fan of first person shooters I was very hesitant to play this game. After having played \n","3 primeiras amostras validação:\n","True Samuel Fuller is hardly one of America's great directors. I'm not sure he qualifies as one of Hollyw\n","True Rich, alcoholic Robert Stack falls in love with secretary Lauren Bacall. He marries her and is so ha\n","True At least I was able to enjoy mocking the movie which is surprising since I was barely able to sit th\n","3 últimas amostras validação:\n","True I originally watched 8 simple rules on the Disney channel UK for the first series and got completely\n","True It's a good movie maybe I like it because it was filmed here in PR. The actors did a good performanc\n","True I loved Dedee Pfeiffer (is that spelled right?) in Cybil. Haven't seen her for awhile and forgot how\n"]}]},{"cell_type":"markdown","metadata":{"id":"JNAftHxu5vVS"},"source":["# Defindo Dataset e Dataloader"]},{"cell_type":"code","metadata":{"id":"OjO3Xiwj5vVU","executionInfo":{"status":"ok","timestamp":1638994482127,"user_tz":180,"elapsed":9,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}}},"source":["class IMDBDataset(torch.utils.data.Dataset):   \n","    def __init__(self, sentences, labels,max_len,model_tokens):\n","        super().__init__()\n","\n","        self.tokenizer = AutoTokenizer.from_pretrained(model_tokens)\n","        self.tokens = self.tokenizer(sentences, padding = \"max_length\", max_length = max_len, truncation=True)[\"input_ids\"]\n","        self.mask_attention = self.tokenizer(sentences, padding = \"max_length\", max_length = max_len, truncation=True)[\"attention_mask\"]\n","        self.labels = labels \n","      \n","    def __len__(self):\n","        return len(self.labels)\n","         \n","    def __getitem__(self, idx):\n","      return torch.tensor(self.tokens[idx]).long(), torch.tensor(self.mask_attention[idx]).long(), torch.tensor(self.labels[idx]).long()\n","    \n","\n","class IMDBDataModule(pl.LightningDataModule):\n","    def __init__(self,model_tokens,\n","                 x_train,y_train, \n","                 x_val,y_val, \n","                 x_test,y_test,\n","                 batch_size: int = 50, \n","                 num_workers: int = 2,\n","                 max_len = 512):\n","        super().__init__()\n","        self.batch_size = batch_size\n","        self.num_workers = num_workers\n","        self.model_token = model_tokens\n","        self.max_len = max_len\n","        self.x_train =  x_train\n","        self.y_train =  y_train\n","        self.x_val = x_val\n","        self.y_val = y_val\n","        self.x_test = x_test\n","        self.y_test = y_test\n","        \n","        \n","                  \n","    def setup(self, stage=None):\n","        if stage == 'fit' or stage is None:\n","          self.train_dataset= IMDBDataset(list(self.x_train), list(self.y_train), self.max_len, model_tokens = self.model_token)\n","          self.val_dataset = IMDBDataset(list(self.x_val), list(self.y_val), self.max_len, model_tokens = self.model_token)\n","        if stage == 'test' or stage is None:\n","            self.test_dataset =  IMDBDataset(list(self.x_test), list(self.y_test), self.max_len, model_tokens = self.model_token)\n","\n","    def train_dataloader(self):\n","        return DataLoader(self.train_dataset, batch_size=self.batch_size, shuffle=True)\n","\n","    def val_dataloader(self):\n","        return DataLoader(self.val_dataset, batch_size=self.batch_size,drop_last=True)\n","\n","    def test_dataloader(self):\n","        return DataLoader(self.test_dataset, batch_size=self.batch_size,drop_last=True)"],"execution_count":6,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"XSZ_5L-pL2YM"},"source":["# BERT from Scratch"]},{"cell_type":"code","source":["ViTModel.from_pretrained('google/vit-base-patch16-224')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4L2mt6q-LZeB","executionInfo":{"status":"ok","timestamp":1638994483734,"user_tz":180,"elapsed":1614,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}},"outputId":"a3b73627-12e3-4921-96b4-19927552d146"},"execution_count":7,"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at google/vit-base-patch16-224 were not used when initializing ViTModel: ['classifier.weight', 'classifier.bias']\n","- This IS expected if you are initializing ViTModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing ViTModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of ViTModel were not initialized from the model checkpoint at google/vit-base-patch16-224 and are newly initialized: ['vit.pooler.dense.bias', 'vit.pooler.dense.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]},{"output_type":"execute_result","data":{"text/plain":["ViTModel(\n","  (embeddings): ViTEmbeddings(\n","    (patch_embeddings): PatchEmbeddings(\n","      (projection): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))\n","    )\n","    (dropout): Dropout(p=0.0, inplace=False)\n","  )\n","  (encoder): ViTEncoder(\n","    (layer): ModuleList(\n","      (0): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (1): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (2): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (3): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (4): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (5): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (6): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (7): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (8): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (9): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (10): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (11): ViTLayer(\n","        (attention): ViTAttention(\n","          (attention): ViTSelfAttention(\n","            (query): Linear(in_features=768, out_features=768, bias=True)\n","            (key): Linear(in_features=768, out_features=768, bias=True)\n","            (value): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","          (output): ViTSelfOutput(\n","            (dense): Linear(in_features=768, out_features=768, bias=True)\n","            (dropout): Dropout(p=0.0, inplace=False)\n","          )\n","        )\n","        (intermediate): ViTIntermediate(\n","          (dense): Linear(in_features=768, out_features=3072, bias=True)\n","        )\n","        (output): ViTOutput(\n","          (dense): Linear(in_features=3072, out_features=768, bias=True)\n","          (dropout): Dropout(p=0.0, inplace=False)\n","        )\n","        (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","    )\n","  )\n","  (layernorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","  (pooler): ViTPooler(\n","    (dense): Linear(in_features=768, out_features=768, bias=True)\n","    (activation): Tanh()\n","  )\n",")"]},"metadata":{},"execution_count":7}]},{"cell_type":"code","source":["def _make_trainable(module):\n","    \"\"\"Unfreeze a given module.\n","    Operates in-place.\n","    Parameters\n","    ----------\n","    module : instance of `torch.nn.Module`\n","    \"\"\"\n","    for param in module.parameters():\n","        param.requires_grad = True\n","    module.train()\n","\n","def freeze(module, n=-1, train_bn=False):\n","    \"\"\"Freeze the layers up to index n.\n","    Operates in-place.\n","    Parameters\n","    ----------\n","    module : instance of `torch.nn.Module`\n","    n : int\n","        By default, all the layers will be frozen. Otherwise, an integer\n","        between 0 and `len(module.children())` must be given.\n","    train_bn : bool (default: True)\n","        If True, the BatchNorm layers will remain in training mode.\n","    \"\"\"\n","    idx = 0\n","    children = list(module.children())\n","    n_max = len(children) if n == -1 else int(n)\n","    for child in children:\n","        if idx < n_max:\n","            _recursive_freeze(module=child, train_bn=train_bn)\n","        else:\n","            _make_trainable(module=child)\n","\n","def _recursive_freeze(module, train_bn=False):\n","    \"\"\"Freeze the layers of a given module.\n","    Operates in-place.\n","    Parameters\n","    ----------\n","    module : instance of `torch.nn.Module`\n","    train_bn : bool (default: True)\n","        If True, the BatchNorm layers will remain in training mode.\n","        Otherwise, they will be set to eval mode along with the other modules.\n","    \"\"\"\n","    children = list(module.children())\n","    if not children:\n","        if not (isinstance(module, torch.nn.LayerNorm) and train_bn):\n","            for param in module.parameters():\n","                param.requires_grad = False\n","            module.eval()\n","        else:\n","            # Make the BN layers trainable\n","            _make_trainable(module)\n","    else:\n","        for child in children:\n","            _recursive_freeze(module=child, train_bn=train_bn)"],"metadata":{"id":"eMmLQ_j9pled","executionInfo":{"status":"ok","timestamp":1638994483737,"user_tz":180,"elapsed":11,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}}},"execution_count":8,"outputs":[]},{"cell_type":"code","metadata":{"id":"T2DJ0aXcGiZX","executionInfo":{"status":"ok","timestamp":1638994483739,"user_tz":180,"elapsed":11,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}}},"source":["def randomize_model(model):\n","    for module_ in model.named_modules(): \n","        if isinstance(module_[1],(torch.nn.Linear, torch.nn.Embedding)):\n","            nn.init.xavier_uniform_(module_[1].weight.data, gain=1.0)\n","        elif isinstance(module_[1], torch.nn.LayerNorm):\n","            module_[1].bias.data.zero_()\n","            module_[1].weight.data.fill_(1.0)\n","        if isinstance(module_[1], torch.nn.Linear) and module_[1].bias is not None:\n","            module_[1].bias.data.zero_()\n","    return model"],"execution_count":9,"outputs":[]},{"cell_type":"code","metadata":{"id":"mfDRlulWS03s","executionInfo":{"status":"ok","timestamp":1638994485024,"user_tz":180,"elapsed":1295,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}}},"source":["class ReviewClassifier(nn.Module):\n","    def __init__(self,num_class, \n","                 bert_model = 'bert-base-uncased'):\n","        super().__init__()\n","\n","        \n","        self.num_class = num_class\n","        \n","        self.bert_layer = BertModel.from_pretrained('bert-base-uncased')\n","\n","        self.ViT_layer = ViTModel.from_pretrained('google/vit-base-patch16-224')\n","\n","        # Alterando camada 0 do BERT para adicionar camada 0 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[0].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[0].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[0].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[0].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[0].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[0].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[0].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[0].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[0].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[0].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[0].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[0].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[0].output.dense.load_state_dict(self.ViT_layer.encoder.layer[0].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[0].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[0].layernorm_after.state_dict())\n","\n","        # Alterando camada 1 do BERT para adicionar camada 1 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[1].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[1].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[1].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[1].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[1].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[1].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[1].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[1].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[1].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[1].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[1].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[1].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[1].output.dense.load_state_dict(self.ViT_layer.encoder.layer[1].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[1].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[1].layernorm_after.state_dict())\n","\n","        # Alterando camada 2 do BERT para adicionar camada 2 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[2].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[2].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[2].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[2].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[2].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[2].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[2].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[2].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[2].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[2].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[2].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[2].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[2].output.dense.load_state_dict(self.ViT_layer.encoder.layer[2].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[2].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[2].layernorm_after.state_dict())\n","        \n","        # Alterando camada 3 do BERT para adicionar camada 3 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[3].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[3].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[3].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[3].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[3].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[3].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[3].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[3].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[3].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[3].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[3].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[3].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[3].output.dense.load_state_dict(self.ViT_layer.encoder.layer[3].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[3].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[3].layernorm_after.state_dict())\n","\n","        # Alterando camada 4 do BERT para adicionar camada 4 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[4].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[4].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[4].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[4].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[4].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[4].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[4].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[4].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[4].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[4].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[4].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[4].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[4].output.dense.load_state_dict(self.ViT_layer.encoder.layer[4].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[4].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[4].layernorm_after.state_dict())\n","\n","        # Alterando camada 5 do BERT para adicionar camada 5 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[5].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[5].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[5].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[5].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[5].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[5].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[5].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[5].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[5].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[5].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[5].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[5].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[5].output.dense.load_state_dict(self.ViT_layer.encoder.layer[5].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[5].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[5].layernorm_after.state_dict())\n","\n","        # Alterando camada 6 do BERT para adicionar camada 6 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[6].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[6].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[6].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[6].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[6].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[6].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[6].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[6].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[6].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[6].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[6].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[6].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[6].output.dense.load_state_dict(self.ViT_layer.encoder.layer[6].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[6].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[6].layernorm_after.state_dict())\n","\n","        # Alterando camada 7 do BERT para adicionar camada 7 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[7].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[7].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[7].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[7].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[7].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[7].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[7].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[7].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[7].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[7].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[7].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[7].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[7].output.dense.load_state_dict(self.ViT_layer.encoder.layer[7].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[7].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[7].layernorm_after.state_dict())\n","\n","        # Alterando camada 8 do BERT para adicionar camada 8 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[8].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[8].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[8].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[8].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[8].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[8].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[8].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[8].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[8].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[8].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[8].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[8].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[8].output.dense.load_state_dict(self.ViT_layer.encoder.layer[8].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[8].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[8].layernorm_after.state_dict())\n","        \n","        # Alterando camada 9 do BERT para adicionar camada 9 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[9].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[9].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[9].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[9].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[9].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[9].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[9].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[9].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[9].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[9].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[9].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[9].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[9].output.dense.load_state_dict(self.ViT_layer.encoder.layer[9].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[9].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[9].layernorm_after.state_dict())\n","\n","        # Alterando camada 10 do BERT para adicionar camada 10 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[10].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[10].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[10].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[10].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[10].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[10].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[10].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[10].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[10].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[10].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[10].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[10].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[10].output.dense.load_state_dict(self.ViT_layer.encoder.layer[10].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[10].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[10].layernorm_after.state_dict())\n","\n","        # Alterando camada 11 do BERT para adicionar camada 11 do ViT\n","        # Camadas de atenção\n","        self.bert_layer.encoder.layer[11].attention.self.query.load_state_dict(self.ViT_layer.encoder.layer[11].attention.attention.query.state_dict())\n","        self.bert_layer.encoder.layer[11].attention.self.key.load_state_dict(self.ViT_layer.encoder.layer[11].attention.attention.key.state_dict())\n","        self.bert_layer.encoder.layer[11].attention.self.value.load_state_dict(self.ViT_layer.encoder.layer[11].attention.attention.value.state_dict())\n","\n","        # Camadas Densas e Normalizações\n","        self.bert_layer.encoder.layer[11].attention.output.dense.load_state_dict(self.ViT_layer.encoder.layer[11].attention.output.dense.state_dict())\n","        self.bert_layer.encoder.layer[11].attention.output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[11].layernorm_before.state_dict())\n","        self.bert_layer.encoder.layer[11].intermediate.dense.load_state_dict(self.ViT_layer.encoder.layer[11].intermediate.dense.state_dict())\n","        self.bert_layer.encoder.layer[11].output.dense.load_state_dict(self.ViT_layer.encoder.layer[11].output.dense.state_dict())\n","        self.bert_layer.encoder.layer[11].output.LayerNorm.load_state_dict(self.ViT_layer.encoder.layer[11].layernorm_after.state_dict())\n","        \n","        #Classification layer\n","        self.cls_layer = nn.Linear(self.bert_layer.config.hidden_size, self.num_class)\n","\n","        # \"Delete\" Unused                \n","        self.ViT_layer = None\n","\n","        # Perform Freezing\n","        freeze(self.bert_layer.encoder)\n","\n","        # Perform Initialization\n","        randomize_model(self.cls_layer)\n","\n","        print('Camadas e requires_grad:')\n","        for name, param in self.bert_layer.named_parameters():                \n","            print(f'{name}:{param.requires_grad}')\n","\n","\n","\n","    def forward(self, seq, attn_masks):\n","        out_bert = self.bert_layer(seq, attention_mask = attn_masks)\n","        logits = self.cls_layer(out_bert.pooler_output)\n","        return logits    \n","\n","class LiteModel(pl.LightningModule):\n","    def __init__(self, hparams):\n","        super().__init__()\n","        self.params = hparams\n","        self.best_valid_loss = 16e9\n","        self.criterion = torch.nn.CrossEntropyLoss()\n","        self.model = ReviewClassifier( num_class = hparams['n_classes'],\n","                                      bert_model = hparams['bert_model'])\n","        \n","    # will be used during inference\n","    def forward(self, x_indexs, x_att_mask):\n","      logits = self.model(x_indexs, x_att_mask)\n","      preds = logits.argmax(dim=1)\n","      return logits, preds\n","\n","    def training_step(self, train_batch, batch_idx):\n","      x_indexs, x_att_mask, y = train_batch\n","      logits = self.model(x_indexs, x_att_mask)\n","\n","      # calcula a perda\n","      batch_losses = self.criterion(logits.squeeze(-1), y)\n","      loss = batch_losses.mean()\n","      run['train/batch_loss'].log(loss)\n","      return {'loss': loss, 'batch_losses': batch_losses}\n","\n","    def training_epoch_end(self, outputs):\n","        avg_loss = torch.stack([output['batch_losses'] for output in outputs]).mean()\n","\n","        run['train/loss'].log(avg_loss)\n","        self.log('train_loss', avg_loss, on_epoch=True, prog_bar=True)\n","        \n","        return\n","  \n","    def validation_step(self, val_batch, batch_idx):\n","        x_indexs, x_att_mask, y = val_batch\n","        \n","        # Transforma a entrada para duas dimensões\n","        # predict da rede\n","        logits, preds = self.forward(x_indexs, x_att_mask)\n","        \n","        # calcula a perda\n","        batch_losses = self.criterion(logits, y)\n","        # calcula a acurácia\n","        batch_accuracy = (preds == y)\n","\n","        val_f1 = torchmetrics.functional.f1(preds, y, num_classes=2, average='weighted')\n","        # Retornamos as losses do batch para podermos fazer a média no validation_epoch_end.\n","        return {'batch_losses': batch_losses, 'batch_accuracy': batch_accuracy,\n","                \"batch_f1\": val_f1}\n","\n","    def validation_epoch_end(self, outputs):\n","        avg_loss = torch.stack([output['batch_losses'] for output in outputs]).mean()\n","        accuracy = torch.stack([output['batch_accuracy'] for output in outputs]).float().mean()\n","        f1 = torch.stack([output['batch_f1'] for output in outputs]).float().mean()\n","\n","\n","        run['valid/loss'].log(avg_loss)\n","        run['valid/acuracy'].log(accuracy)\n","        run['valid/F1'].log(f1)\n","\n","        metrics = {'valid_loss': avg_loss.item(), 'accuracy': accuracy.item(), 'f1-score':f1.item()}\n","        output =  {'progress_bar': metrics, 'valid_loss': avg_loss.item()}\n","\n","        #salva o melhor modelo\n","               \n","        if avg_loss < self.best_valid_loss:\n","            torch.save(self.model.state_dict(), '/content/'+self.params['bert_model']+'best_model.pt')\n","            self.best_valid_loss = avg_loss\n","        torch.save(self.model.state_dict(), '/content/'+self.params['bert_model']+'trainer_model.pt')\n","\n","\n","        self.log('validate_loss', avg_loss, on_epoch=True, prog_bar=True)\n","        self.log('validate_acc', accuracy, on_epoch=True, prog_bar=True)\n","        self.log('validate_f1', f1, on_epoch=True, prog_bar=True)\n","        return output\n","  \n","    def test_step(self, val_batch, batch_idx):\n","        # A implementação deste método é opcional no Pytorch Lightning.\n","        x_indexs, x_att_mask, y = val_batch\n","        \n","        # predict da rede\n","        logits, preds = self.forward(x_indexs, x_att_mask)\n","\n","        # calcula a perda\n","        batch_losses = self.criterion(logits, y)\n","        # calcula a acurácia\n","        batch_accuracy = (preds == y)\n","        test_f1 = torchmetrics.functional.f1(preds, y, num_classes=2, average='weighted')\n","        \n","        # Retornamos as losses do batch para podermos fazer a média no validation_epoch_end.\n","        return {'batch_losses': batch_losses, 'batch_accuracy': batch_accuracy,\n","                'batch_f1':test_f1}\n","\n","    def test_epoch_end(self, outputs):\n","        # A implementação deste método é opcional no Pytorch Lightning.\n","        avg_loss = torch.stack([output['batch_losses'] for output in outputs]).mean()\n","        accuracy = torch.stack([output['batch_accuracy'] for output in outputs]).float().mean()\n","        f1 = torch.stack([output['batch_f1'] for output in outputs]).float().mean()\n","\n","        metrics = {'Test loss': avg_loss.item(), 'test accuracy': accuracy.item(), 'test f1':f1.item()}\n","        output =  {'progress_bar': metrics}\n","\n","        run['test/loss'].log(avg_loss)\n","        run['test/acuracy'].log(accuracy)\n","        run['test/F1'].log(f1)\n","\n","        self.log('test_loss', avg_loss, on_epoch=True, prog_bar=True)\n","        self.log('test_acc', accuracy,  on_epoch=True, prog_bar=True)\n","        self.log('test_f1', f1,  on_epoch=True, prog_bar=True)\n","        return output\n","\n","    def configure_optimizers(self):\n","        # Gradiente descendente\n","        optimizer = torch.optim.Adamax(self.model.parameters(), lr=self.params['learning_rate'])\n","        \n","        # Aqui usamos um scheduler dummy pois o pytorch lightning original requer um.\n","        scheduler = torch.optim.lr_scheduler.MultiplicativeLR(optimizer, lr_lambda=lambda epoch: 1.0)\n","        return [optimizer], [scheduler]  # Forma de retorno para associar um otimizador a um scheduler.\n"],"execution_count":10,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"Y7fscY3IRACd"},"source":["# Experiment"]},{"cell_type":"code","metadata":{"id":"sX17axDrS03v","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1638994487014,"user_tz":180,"elapsed":1995,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}},"outputId":"be055782-1ce0-4e34-cab9-02de0441796e"},"source":["run = neptune.init(\n","    project=\"leonardoboulitreau/CrossModal\",\n","    api_token=\"eyJhcGlfYWRkcmVzcyI6Imh0dHBzOi8vYXBwLm5lcHR1bmUuYWkiLCJhcGlfdXJsIjoiaHR0cHM6Ly9hcHAubmVwdHVuZS5haSIsImFwaV9rZXkiOiIwZDM3MTQ4NC1kMzMxLTRjYjEtYmFlMy1iNGI2NmIxOWNhOGMifQ==\",\n",")  # your credentials"],"execution_count":11,"outputs":[{"output_type":"stream","name":"stdout","text":["https://app.neptune.ai/leonardoboulitreau/CrossModal/e/CROS-28\n"]}]},{"cell_type":"code","metadata":{"id":"1LlTZfNUS03v","colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["9e229cbc1b294edd8a403fc44db25b64","960464733f784dd8a3ad309e2db5b9b4","32ddbde6375c46a7b123207a9cf40eb0","c50ead940c3f48f0a7f130670b6c2b15","9a6774711c0d43b7904f3fe0bb65b4e0","cac8e3e19687461f9bb5738b8d463de3","353ba2d949f346a094dd4cb2ad90f06c","3ba21f17e9b046b58c4536635ff1d7f9","1d74e0b8322047b19b7d019c7c188a75","226b011c5f594052a7dbc782f223e90f","98fb25332fa7439facfd6112c4a36b6a","8c9ce6732f0842d68f3689fe0f38b4d7","0853f5f280a848b6a9249261338159eb","e0e286ac31974dab8dba3dd86f7a80bd","ec3081dc666e44c7b7cfcdf401895120","e165f3a236164d7c972728e1f9ed3d9b","73b4d1fdeb1943b6ae0c5c7da7f0aad8","1c8fc21453784c06874a3ac717773fde","6d76908c03ed4bd69906dde73f655179","efee10c7e44c4fabb3806693e74ce66a","bf84d1469c464a3db7f83c641f020ad4","cd5bb988f3884d42b3497429201efd5b","f5e945e01e784b7e841c896de5494528","fd3a5007ead044c2819736270e5be6d8","4259195735bf4a37a7a5d714157c8c3d","6666ef1d4c5a45ffb3d854935822dbbd","568505b3b5f84f65a3d9a8cd9ff44a02","1a7c5201e0684e79922efe5d5403c0ed","9a9ae0b4d5834b98b5ee0a109d9c0aea","9b80ceb865b6414d83537e12d695db43","8b0f01a547504f08b11edf8c5c0e35b2","ac3284bd1f07408786204d8d6613e59d","6eb3760dc2774bfe875444674ddc27fa","2c5a18ae2b594f0c800775d3b5442680","7d3d63fb4ac54a3da255873d0be2ae7d","bd2661adde7f4b499ba43637af931a8a","b0842995ec6648f9b0a1787cf5a81916","dee47fd2479a4a7995ca9b8197656d1f","2e12c55daffd41278ea73212d3957a76","854a0eb2c639403f8459026cb46c8483","cc06a8a1d18d44dbb2242a2533b4f34c","48d85c9ab4864453a1ebb6e6e0d965b8","52c189c57a2345049361670444091408","7d7ab68515c14065a156a14ca54e612e","accfb7f1f884448e9d2f4a54222289a3","6ba0bf27dfff48a1a3785fa259753536","c7855ed240e2442d8fe25983fc7208d3","42aa4c9f9f3e46e08a3c173169e14482","311693a48e0e40b7ab0757c9a58c3d66","b315d756f4d54cb381eb12b084941b24","448e79a6cf7a4b6e984b368f4ad52867","316a0f6b8025465b8fd16411b5ad9e80","62367fb5f5aa44ba86204cb5bbda5a1d","574dd20364b34c1ab7b1ce5bd9ac4f1f","1adaace6526c48c08d1a0661a3e8309d","7037575f14784457a76c004416321362","fdba797e892d4a10a1ee208f7143a889","54604457238f48b88293aec84231142f","6b1b7c4fb54a4abdbecd38865bcb8b5b","355749dd22a745ec94c9a181e2470a1e","0785086396ed4784a7fd4c21e9b68c12","f9943b77264348398fcb2dce7057bed6","2f6dc19968674e228c71b780caedf125","f8703951361d4bfeb05e3e15c19a9f96","93cb6c0dc9264e7090ea57e717e56507","4b5da6ba154e47be8fa519894f6cc8d4","dbb5d44215914b19be591466408039f6","07d5256254094700947561f7c89abd6b","d942473b012a4079aec0d9bd930bcd16","ca9fd28739e54d0eb229590a71fac68f","7007aa08c10644c6a2c2a7ffd51bae25","9bbd61688d7e426db1da4e60f7c2e6e9","59a52e99f82d4cf1b8489c49fc783f86","a379eae42840434a85b39b604109a231","43b73c525e6141a6ad324eea98ed8996","10f3d58e5de04d9b865263ff751968d8","025b9792b2d344faa243b0a14844f594","ec285f6025be48d2b649544361ef204b","62d1b95e7ebd467ba9d8249440978cc4","db205e25d9104db0ac6c515c7d272232","09bbaf95db5149acb17739445ad066b4","b9ebb0ce3c8f4c91a4b56f8f1ab21cc7","861940bfe9ab461c8cda4ee8185f5353","1cda4165a39d45e08448d8d10af503f8","dacb7d6836824a80a51f1046be08eabc","43558caee02840a092b7a8a11aec7f32","3692c6be3e494accad94cd26f990aeb7","4895f2e3bd2b42ee84eb7d8040031c27","af3e6c5c6b364bf88131d3595d269b87","e7dadf3ffaa84bbfbf838480a5f2726a","80647379f9364e7183ef8e1b28814b51","3ccbf7e1ca08463ab8ba2137b8920e8a","8c6cf3f7de1f48ccaab3bd0055f858e5","0a5ce6f2ecaf434daf1731df27c08c2f","71db9a3127d3409689164c37d63538fd","bbf95ed5b4d94c9da4abd3fdeaf0ade3","b634992e6bd448cdb03ccf1584cf001f","cd0d0ffa374f4463bb3db3b57263e73c","2c9b175f4cb84cb2ac2bdb8d5c44e038","65eccfd178484106907e539a64cf5c0f","144411001c674d598b8d637f1355e4eb","22696c5d00b64f6d8ec964ff22f1f1a6","776e58f85c2e485fb4e56186e93eb8dc","4202364f88c64339b3a0c9f9df47204f","f50fe07b4e83459a8bae4eab29ca7b5a","8ab37dda737e41dbb5b55aea4a95466c","58fbfb621d2143bd9629022a3cfc15a8","8366cf0526c24a23ba40ab2089da00d1","8ffb0e1f7e604f9a9ce1588f7b80fbbf","e491ac40d82e42cfae23e4edb55b22de","68ecee54c913419fb4e30706cfc760b0","d9da09de56e4466b9edbe261fd929d89","0cd8aa3bb0e64946bd810a3ceaea629d","8be68cff59c240fda531f2b0c9db8e6b","acfb490f951247c08c986f423cd6f52a","5a17a8a937c2440dbbb001af667a939c","07855c9539bd42db9eb7a58bfebc257e","a0c75ebd1ba44170957050f2578b5241","6742ba23397a4bccb94e2da499b209fd","3a354a7fde8744199f5b5fd8518c4158","6dd3e8776162426e9aeebc4a450eea63","fcdbaa4ff86e4901bff0f92c3391e561","3343d45c2a9640ab9ccd4e9a16d7f396","c5d8a849d592431d838a28e5424d4b66","903de00386944fa6ad08f20eb266ab01","875b7cb0c21841be9b1fe2904b1a0427","eaf9660139d9459c970b31911a861ce8","483ad874fd0e4e879ccdc5a96215723a","d8cfd37b4c3e40c5a66ca4604ae9d562","6150fd0038a248dba2d9eebf25ce635a","5bfab547f1904f9a9cd827fff1eb1f90","598b8bbb13aa4196bdf0b4a18e1f6a23","922a6525a0a940b48031e8666e842941","f81b3f6f974a4f71b967e8fb041e43b4","c56793a150e54117b4beeca9dcfa8073","0c53b7743c6343cbaf80eadb9ca92fe4","004d22cec7ff4a39aae2fd95a08b4e55","35097746c33948768a9da2a6d79bd5e8","068cd51f4488406c9adabb33c7bf30b6","dc60e49d35cc43378b9886d3187a7486","7d4cf761dde34a878ff76c10f2f8583a","32a2014a926a4cc68f6495682fdb994f","dd658345a30b460f903771fcfbec084d"]},"executionInfo":{"status":"ok","timestamp":1639004220697,"user_tz":180,"elapsed":9733688,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}},"outputId":"9043a217-e219-4ca8-bee6-aaeffa36c1db"},"source":["# definindo os hyperparametros\n","hparams = {\n","    'max_epochs': 11,\n","    'max_len':512,\n","    'n_classes':2,\n","    'bert_model':'bert-base-uncased',\n","    'learning_rate': 1e-4,\n","    'bs':16\n","    \n","}\n","\n","\n","dm = IMDBDataModule(batch_size=hparams['bs'],x_train = x_train, y_train = y_train,\n","                    x_val=x_valid, y_val = y_valid, \n","                    x_test= x_test, y_test = y_test,\n","                    model_tokens = hparams['bert_model'],max_len=hparams['max_len'])\n","dm.setup()\n","\n","pl_model = LiteModel(hparams=hparams)\n","\n","trainer = pl.Trainer(max_epochs=hparams['max_epochs'],\n","                     progress_bar_refresh_rate = 1,\n","                     accumulate_grad_batches = 5,\n","                     gpus=1,\n","                     log_every_n_steps=1) \n","\n","%time trainer.fit(pl_model, dm)"],"execution_count":12,"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.weight', 'cls.predictions.transform.dense.weight']\n","- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of the model checkpoint at google/vit-base-patch16-224 were not used when initializing ViTModel: ['classifier.weight', 'classifier.bias']\n","- This IS expected if you are initializing ViTModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing ViTModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of ViTModel were not initialized from the model checkpoint at google/vit-base-patch16-224 and are newly initialized: ['vit.pooler.dense.bias', 'vit.pooler.dense.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","/usr/local/lib/python3.7/dist-packages/pytorch_lightning/trainer/connectors/callback_connector.py:91: LightningDeprecationWarning: Setting `Trainer(progress_bar_refresh_rate=1)` is deprecated in v1.5 and will be removed in v1.7. Please pass `pytorch_lightning.callbacks.progress.TQDMProgressBar` with `refresh_rate` directly to the Trainer's `callbacks` argument instead. Or, to disable the progress bar pass `enable_progress_bar = False` to the Trainer.\n","  f\"Setting `Trainer(progress_bar_refresh_rate={progress_bar_refresh_rate})` is deprecated in v1.5 and\"\n","GPU available: True, used: True\n","TPU available: False, using: 0 TPU cores\n","IPU available: False, using: 0 IPUs\n","/usr/local/lib/python3.7/dist-packages/pytorch_lightning/core/datamodule.py:470: LightningDeprecationWarning: DataModule.setup has already been called, so it will not be called again. In v1.6 this behavior will change to always call DataModule.setup.\n","  f\"DataModule.{name} has already been called, so it will not be called again. \"\n","LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\n"]},{"output_type":"stream","name":"stdout","text":["Camadas e requires_grad:\n","embeddings.word_embeddings.weight:True\n","embeddings.position_embeddings.weight:True\n","embeddings.token_type_embeddings.weight:True\n","embeddings.LayerNorm.weight:True\n","embeddings.LayerNorm.bias:True\n","encoder.layer.0.attention.self.query.weight:False\n","encoder.layer.0.attention.self.query.bias:False\n","encoder.layer.0.attention.self.key.weight:False\n","encoder.layer.0.attention.self.key.bias:False\n","encoder.layer.0.attention.self.value.weight:False\n","encoder.layer.0.attention.self.value.bias:False\n","encoder.layer.0.attention.output.dense.weight:False\n","encoder.layer.0.attention.output.dense.bias:False\n","encoder.layer.0.attention.output.LayerNorm.weight:False\n","encoder.layer.0.attention.output.LayerNorm.bias:False\n","encoder.layer.0.intermediate.dense.weight:False\n","encoder.layer.0.intermediate.dense.bias:False\n","encoder.layer.0.output.dense.weight:False\n","encoder.layer.0.output.dense.bias:False\n","encoder.layer.0.output.LayerNorm.weight:False\n","encoder.layer.0.output.LayerNorm.bias:False\n","encoder.layer.1.attention.self.query.weight:False\n","encoder.layer.1.attention.self.query.bias:False\n","encoder.layer.1.attention.self.key.weight:False\n","encoder.layer.1.attention.self.key.bias:False\n","encoder.layer.1.attention.self.value.weight:False\n","encoder.layer.1.attention.self.value.bias:False\n","encoder.layer.1.attention.output.dense.weight:False\n","encoder.layer.1.attention.output.dense.bias:False\n","encoder.layer.1.attention.output.LayerNorm.weight:False\n","encoder.layer.1.attention.output.LayerNorm.bias:False\n","encoder.layer.1.intermediate.dense.weight:False\n","encoder.layer.1.intermediate.dense.bias:False\n","encoder.layer.1.output.dense.weight:False\n","encoder.layer.1.output.dense.bias:False\n","encoder.layer.1.output.LayerNorm.weight:False\n","encoder.layer.1.output.LayerNorm.bias:False\n","encoder.layer.2.attention.self.query.weight:False\n","encoder.layer.2.attention.self.query.bias:False\n","encoder.layer.2.attention.self.key.weight:False\n","encoder.layer.2.attention.self.key.bias:False\n","encoder.layer.2.attention.self.value.weight:False\n","encoder.layer.2.attention.self.value.bias:False\n","encoder.layer.2.attention.output.dense.weight:False\n","encoder.layer.2.attention.output.dense.bias:False\n","encoder.layer.2.attention.output.LayerNorm.weight:False\n","encoder.layer.2.attention.output.LayerNorm.bias:False\n","encoder.layer.2.intermediate.dense.weight:False\n","encoder.layer.2.intermediate.dense.bias:False\n","encoder.layer.2.output.dense.weight:False\n","encoder.layer.2.output.dense.bias:False\n","encoder.layer.2.output.LayerNorm.weight:False\n","encoder.layer.2.output.LayerNorm.bias:False\n","encoder.layer.3.attention.self.query.weight:False\n","encoder.layer.3.attention.self.query.bias:False\n","encoder.layer.3.attention.self.key.weight:False\n","encoder.layer.3.attention.self.key.bias:False\n","encoder.layer.3.attention.self.value.weight:False\n","encoder.layer.3.attention.self.value.bias:False\n","encoder.layer.3.attention.output.dense.weight:False\n","encoder.layer.3.attention.output.dense.bias:False\n","encoder.layer.3.attention.output.LayerNorm.weight:False\n","encoder.layer.3.attention.output.LayerNorm.bias:False\n","encoder.layer.3.intermediate.dense.weight:False\n","encoder.layer.3.intermediate.dense.bias:False\n","encoder.layer.3.output.dense.weight:False\n","encoder.layer.3.output.dense.bias:False\n","encoder.layer.3.output.LayerNorm.weight:False\n","encoder.layer.3.output.LayerNorm.bias:False\n","encoder.layer.4.attention.self.query.weight:False\n","encoder.layer.4.attention.self.query.bias:False\n","encoder.layer.4.attention.self.key.weight:False\n","encoder.layer.4.attention.self.key.bias:False\n","encoder.layer.4.attention.self.value.weight:False\n","encoder.layer.4.attention.self.value.bias:False\n","encoder.layer.4.attention.output.dense.weight:False\n","encoder.layer.4.attention.output.dense.bias:False\n","encoder.layer.4.attention.output.LayerNorm.weight:False\n","encoder.layer.4.attention.output.LayerNorm.bias:False\n","encoder.layer.4.intermediate.dense.weight:False\n","encoder.layer.4.intermediate.dense.bias:False\n","encoder.layer.4.output.dense.weight:False\n","encoder.layer.4.output.dense.bias:False\n","encoder.layer.4.output.LayerNorm.weight:False\n","encoder.layer.4.output.LayerNorm.bias:False\n","encoder.layer.5.attention.self.query.weight:False\n","encoder.layer.5.attention.self.query.bias:False\n","encoder.layer.5.attention.self.key.weight:False\n","encoder.layer.5.attention.self.key.bias:False\n","encoder.layer.5.attention.self.value.weight:False\n","encoder.layer.5.attention.self.value.bias:False\n","encoder.layer.5.attention.output.dense.weight:False\n","encoder.layer.5.attention.output.dense.bias:False\n","encoder.layer.5.attention.output.LayerNorm.weight:False\n","encoder.layer.5.attention.output.LayerNorm.bias:False\n","encoder.layer.5.intermediate.dense.weight:False\n","encoder.layer.5.intermediate.dense.bias:False\n","encoder.layer.5.output.dense.weight:False\n","encoder.layer.5.output.dense.bias:False\n","encoder.layer.5.output.LayerNorm.weight:False\n","encoder.layer.5.output.LayerNorm.bias:False\n","encoder.layer.6.attention.self.query.weight:False\n","encoder.layer.6.attention.self.query.bias:False\n","encoder.layer.6.attention.self.key.weight:False\n","encoder.layer.6.attention.self.key.bias:False\n","encoder.layer.6.attention.self.value.weight:False\n","encoder.layer.6.attention.self.value.bias:False\n","encoder.layer.6.attention.output.dense.weight:False\n","encoder.layer.6.attention.output.dense.bias:False\n","encoder.layer.6.attention.output.LayerNorm.weight:False\n","encoder.layer.6.attention.output.LayerNorm.bias:False\n","encoder.layer.6.intermediate.dense.weight:False\n","encoder.layer.6.intermediate.dense.bias:False\n","encoder.layer.6.output.dense.weight:False\n","encoder.layer.6.output.dense.bias:False\n","encoder.layer.6.output.LayerNorm.weight:False\n","encoder.layer.6.output.LayerNorm.bias:False\n","encoder.layer.7.attention.self.query.weight:False\n","encoder.layer.7.attention.self.query.bias:False\n","encoder.layer.7.attention.self.key.weight:False\n","encoder.layer.7.attention.self.key.bias:False\n","encoder.layer.7.attention.self.value.weight:False\n","encoder.layer.7.attention.self.value.bias:False\n","encoder.layer.7.attention.output.dense.weight:False\n","encoder.layer.7.attention.output.dense.bias:False\n","encoder.layer.7.attention.output.LayerNorm.weight:False\n","encoder.layer.7.attention.output.LayerNorm.bias:False\n","encoder.layer.7.intermediate.dense.weight:False\n","encoder.layer.7.intermediate.dense.bias:False\n","encoder.layer.7.output.dense.weight:False\n","encoder.layer.7.output.dense.bias:False\n","encoder.layer.7.output.LayerNorm.weight:False\n","encoder.layer.7.output.LayerNorm.bias:False\n","encoder.layer.8.attention.self.query.weight:False\n","encoder.layer.8.attention.self.query.bias:False\n","encoder.layer.8.attention.self.key.weight:False\n","encoder.layer.8.attention.self.key.bias:False\n","encoder.layer.8.attention.self.value.weight:False\n","encoder.layer.8.attention.self.value.bias:False\n","encoder.layer.8.attention.output.dense.weight:False\n","encoder.layer.8.attention.output.dense.bias:False\n","encoder.layer.8.attention.output.LayerNorm.weight:False\n","encoder.layer.8.attention.output.LayerNorm.bias:False\n","encoder.layer.8.intermediate.dense.weight:False\n","encoder.layer.8.intermediate.dense.bias:False\n","encoder.layer.8.output.dense.weight:False\n","encoder.layer.8.output.dense.bias:False\n","encoder.layer.8.output.LayerNorm.weight:False\n","encoder.layer.8.output.LayerNorm.bias:False\n","encoder.layer.9.attention.self.query.weight:False\n","encoder.layer.9.attention.self.query.bias:False\n","encoder.layer.9.attention.self.key.weight:False\n","encoder.layer.9.attention.self.key.bias:False\n","encoder.layer.9.attention.self.value.weight:False\n","encoder.layer.9.attention.self.value.bias:False\n","encoder.layer.9.attention.output.dense.weight:False\n","encoder.layer.9.attention.output.dense.bias:False\n","encoder.layer.9.attention.output.LayerNorm.weight:False\n","encoder.layer.9.attention.output.LayerNorm.bias:False\n","encoder.layer.9.intermediate.dense.weight:False\n","encoder.layer.9.intermediate.dense.bias:False\n","encoder.layer.9.output.dense.weight:False\n","encoder.layer.9.output.dense.bias:False\n","encoder.layer.9.output.LayerNorm.weight:False\n","encoder.layer.9.output.LayerNorm.bias:False\n","encoder.layer.10.attention.self.query.weight:False\n","encoder.layer.10.attention.self.query.bias:False\n","encoder.layer.10.attention.self.key.weight:False\n","encoder.layer.10.attention.self.key.bias:False\n","encoder.layer.10.attention.self.value.weight:False\n","encoder.layer.10.attention.self.value.bias:False\n","encoder.layer.10.attention.output.dense.weight:False\n","encoder.layer.10.attention.output.dense.bias:False\n","encoder.layer.10.attention.output.LayerNorm.weight:False\n","encoder.layer.10.attention.output.LayerNorm.bias:False\n","encoder.layer.10.intermediate.dense.weight:False\n","encoder.layer.10.intermediate.dense.bias:False\n","encoder.layer.10.output.dense.weight:False\n","encoder.layer.10.output.dense.bias:False\n","encoder.layer.10.output.LayerNorm.weight:False\n","encoder.layer.10.output.LayerNorm.bias:False\n","encoder.layer.11.attention.self.query.weight:False\n","encoder.layer.11.attention.self.query.bias:False\n","encoder.layer.11.attention.self.key.weight:False\n","encoder.layer.11.attention.self.key.bias:False\n","encoder.layer.11.attention.self.value.weight:False\n","encoder.layer.11.attention.self.value.bias:False\n","encoder.layer.11.attention.output.dense.weight:False\n","encoder.layer.11.attention.output.dense.bias:False\n","encoder.layer.11.attention.output.LayerNorm.weight:False\n","encoder.layer.11.attention.output.LayerNorm.bias:False\n","encoder.layer.11.intermediate.dense.weight:False\n","encoder.layer.11.intermediate.dense.bias:False\n","encoder.layer.11.output.dense.weight:False\n","encoder.layer.11.output.dense.bias:False\n","encoder.layer.11.output.LayerNorm.weight:False\n","encoder.layer.11.output.LayerNorm.bias:False\n","pooler.dense.weight:True\n","pooler.dense.bias:True\n"]},{"output_type":"stream","name":"stderr","text":["\n","  | Name      | Type             | Params\n","-----------------------------------------------\n","0 | criterion | CrossEntropyLoss | 0     \n","1 | model     | ReviewClassifier | 109 M \n","-----------------------------------------------\n","24.4 M    Trainable params\n","85.1 M    Non-trainable params\n","109 M     Total params\n","437.935   Total estimated model params size (MB)\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"9e229cbc1b294edd8a403fc44db25b64","version_minor":0,"version_major":2},"text/plain":["Validation sanity check: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/pytorch_lightning/trainer/data_loading.py:117: UserWarning: The dataloader, val_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 4 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.\n","  f\"The dataloader, {name}, does not have many workers which may be a bottleneck.\"\n","Global seed set to 123\n","/usr/local/lib/python3.7/dist-packages/pytorch_lightning/trainer/data_loading.py:117: UserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 4 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.\n","  f\"The dataloader, {name}, does not have many workers which may be a bottleneck.\"\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"8c9ce6732f0842d68f3689fe0f38b4d7","version_minor":0,"version_major":2},"text/plain":["Training: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/pytorch_lightning/loops/optimization/closure.py:36: LightningDeprecationWarning: One of the returned values {'batch_losses'} has a `grad_fn`. We will detach it automatically but this behaviour will change in v1.6. Please detach it manually: `return {'loss': ..., 'something': something.detach()}`\n","  f\"One of the returned values {set(extra.keys())} has a `grad_fn`. We will detach it automatically\"\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"f5e945e01e784b7e841c896de5494528","version_minor":0,"version_major":2},"text/plain":["Validating: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"2c5a18ae2b594f0c800775d3b5442680","version_minor":0,"version_major":2},"text/plain":["Validating: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"accfb7f1f884448e9d2f4a54222289a3","version_minor":0,"version_major":2},"text/plain":["Validating: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"7037575f14784457a76c004416321362","version_minor":0,"version_major":2},"text/plain":["Validating: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"dbb5d44215914b19be591466408039f6","version_minor":0,"version_major":2},"text/plain":["Validating: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ec285f6025be48d2b649544361ef204b","version_minor":0,"version_major":2},"text/plain":["Validating: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"af3e6c5c6b364bf88131d3595d269b87","version_minor":0,"version_major":2},"text/plain":["Validating: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"65eccfd178484106907e539a64cf5c0f","version_minor":0,"version_major":2},"text/plain":["Validating: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"68ecee54c913419fb4e30706cfc760b0","version_minor":0,"version_major":2},"text/plain":["Validating: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"fcdbaa4ff86e4901bff0f92c3391e561","version_minor":0,"version_major":2},"text/plain":["Validating: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"922a6525a0a940b48031e8666e842941","version_minor":0,"version_major":2},"text/plain":["Validating: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["CPU times: user 2h 41min 44s, sys: 37.5 s, total: 2h 42min 22s\n","Wall time: 2h 41min 25s\n"]}]},{"cell_type":"code","metadata":{"id":"46wttbF7S03x","executionInfo":{"status":"ok","timestamp":1639004683401,"user_tz":180,"elapsed":462710,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}},"colab":{"base_uri":"https://localhost:8080/","height":451,"referenced_widgets":["907542da152948a0b8213d06d9c36504","01e58a4bad344f15b13451e226f5a2b4","f6de14af2dd74cd3b26f399fc5bdcd4b","9ff556e9c2374fb1a495c4da2c3543ea","c32859b824334d808c686a7829a0d2b7","ce93ab7b08ef4da9981cdda21bdaf835","707f88d60b36466db4dcecf1591bd6ef","512c2e61580743c989cf8096446356d4","17a110a2ebc2400aba8ef4c88b396eae","0fec8a15271f485e9cc3f4e9a9dce03e","92ff72c9cf3e48729b9f9229bc87a434"]},"outputId":"6af77913-aa50-4bd5-d78d-61af5ba77e41"},"source":["#teste\n","%time trainer.test(test_dataloaders=dm.test_dataloader())"],"execution_count":13,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/pytorch_lightning/trainer/trainer.py:902: LightningDeprecationWarning: `trainer.test(test_dataloaders)` is deprecated in v1.4 and will be removed in v1.6. Use `trainer.test(dataloaders)` instead.\n","  \"`trainer.test(test_dataloaders)` is deprecated in v1.4 and will be removed in v1.6.\"\n","/usr/local/lib/python3.7/dist-packages/pytorch_lightning/trainer/trainer.py:1395: UserWarning: `.test(ckpt_path=None)` was called without a model. The best model of the previous `fit` call will be used. You can pass `test(ckpt_path='best')` to use and best model checkpoint and avoid this warning or `ckpt_path=trainer.checkpoint_callback.last_model_path` to use the last model.\n","  f\"`.{fn}(ckpt_path=None)` was called without a model.\"\n","/usr/local/lib/python3.7/dist-packages/pytorch_lightning/core/datamodule.py:470: LightningDeprecationWarning: DataModule.setup has already been called, so it will not be called again. In v1.6 this behavior will change to always call DataModule.setup.\n","  f\"DataModule.{name} has already been called, so it will not be called again. \"\n","Restoring states from the checkpoint path at /content/lightning_logs/version_1/checkpoints/epoch=10-step=2749.ckpt\n","LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\n","Loaded model weights from checkpoint at /content/lightning_logs/version_1/checkpoints/epoch=10-step=2749.ckpt\n","/usr/local/lib/python3.7/dist-packages/pytorch_lightning/trainer/data_loading.py:117: UserWarning: The dataloader, test_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 4 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.\n","  f\"The dataloader, {name}, does not have many workers which may be a bottleneck.\"\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"907542da152948a0b8213d06d9c36504","version_minor":0,"version_major":2},"text/plain":["Testing: 0it [00:00, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["--------------------------------------------------------------------------------\n","DATALOADER:0 TEST RESULTS\n","{'test_acc': 0.4998399615287781,\n"," 'test_f1': 0.4997713267803192,\n"," 'test_loss': 0.6908957958221436}\n","--------------------------------------------------------------------------------\n","CPU times: user 7min 44s, sys: 1.38 s, total: 7min 45s\n","Wall time: 7min 42s\n"]},{"output_type":"execute_result","data":{"text/plain":["[{'test_acc': 0.4998399615287781,\n","  'test_f1': 0.4997713267803192,\n","  'test_loss': 0.6908957958221436}]"]},"metadata":{},"execution_count":13}]},{"cell_type":"code","metadata":{"id":"PKnLuShAzR_Q","executionInfo":{"status":"ok","timestamp":1639004683893,"user_tz":180,"elapsed":534,"user":{"displayName":"Leonardo Boulitreau","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GjTv0_6s_ZOXdgawFvihtlM8zNrLp1PmhJGvPAl9w=s64","userId":"14376337709532263652"}}},"source":["run.stop()"],"execution_count":14,"outputs":[]}]}